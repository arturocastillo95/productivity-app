{"ast":null,"code":"import _slicedToArray from\"/Users/arturocastillo/developer/productivity-app/src/productivityreact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import{fancyTimeFormat,getCookie,taskUpdate}from'./utils';import{ActiveTask}from'./SortableList';var Timer=function Timer(_ref){var seconds=_ref.seconds,onTimeUpdate=_ref.onTimeUpdate,markAsComplete=_ref.markAsComplete;// initialize timeLeft with the seconds prop\nvar _useState=useState(seconds),_useState2=_slicedToArray(_useState,2),timeLeft=_useState2[0],setTimeLeft=_useState2[1];useEffect(function(){// exit early when we reach 0\nif(!timeLeft)return;// save intervalId to clear the interval when the\n// component re-renders\nvar intervalId=setInterval(function(){if(timeLeft>0){setTimeLeft(timeLeft-1);onTimeUpdate(timeLeft);}},1000);if(timeLeft===1){setTimeLeft(0);onTimeUpdate(0);markAsComplete();}// clear interval on re-render to avoid memory leaks\nreturn function(){return clearInterval(intervalId);};// add timeLeft as a dependency to re-rerun the effect\n// when we update it\n},[timeLeft]);useEffect(function(){setTimeLeft(seconds);},[seconds]);return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",{className:\"has-text-success\"},fancyTimeFormat(timeLeft)));};export var StartTimer=function StartTimer(_ref2){var value=_ref2.value,onTimerStart=_ref2.onTimerStart,onTimerPause=_ref2.onTimerPause,markAsComplete=_ref2.markAsComplete;var _useState3=useState({'state':'paused','seconds':'0'}),_useState4=_slicedToArray(_useState3,2),timer=_useState4[0],setTimer=_useState4[1];var _useContext=useContext(ActiveTask),active=_useContext.active,setActive=_useContext.setActive;function startTimer(){setTimer({'state':'running','seconds':value.remaining});onTimerStart();setActive(true);}function pauseTimer(){setTimer({'state':'paused','seconds':'0'});setActive(false);onTimerPause();}function timeUpdate(s){var csrf_token=getCookie('csrftoken');var new_remaining=value;new_remaining.remaining=s;taskUpdate(new_remaining,csrf_token);}function resetTimer(){setTimer({'state':'running','seconds':value.duration});}function markTaskComplete(){setActive(false);markAsComplete();}return/*#__PURE__*/React.createElement(\"div\",{className:\"level-item \"+(value.completed?'is-hidden':'')},timer.state==='paused'&&active===false&&/*#__PURE__*/React.createElement(\"a\",{href:\"/#\",onClick:startTimer},/*#__PURE__*/React.createElement(\"span\",{className:\"icon has-text-success\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-play\"}))),timer.state==='running'&&/*#__PURE__*/React.createElement(\"a\",{href:\"/#\",onClick:pauseTimer},/*#__PURE__*/React.createElement(\"span\",{className:\"icon has-text-success\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-pause\"}))),timer.state==='running'&&/*#__PURE__*/React.createElement(Timer,{seconds:timer.seconds,onTimeUpdate:timeUpdate,markAsComplete:markTaskComplete}),timer.state==='running'&&/*#__PURE__*/React.createElement(\"a\",{href:\"/#\"},/*#__PURE__*/React.createElement(\"span\",{className:\"icon has-text-warning\",onClick:resetTimer},\"\\xA0\\xA0\",/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-redo-alt\"}))));};","map":{"version":3,"sources":["/Users/arturocastillo/developer/productivity-app/src/productivityreact/src/components/Timer.js"],"names":["React","useState","useEffect","useContext","fancyTimeFormat","getCookie","taskUpdate","ActiveTask","Timer","seconds","onTimeUpdate","markAsComplete","timeLeft","setTimeLeft","intervalId","setInterval","clearInterval","StartTimer","value","onTimerStart","onTimerPause","timer","setTimer","active","setActive","startTimer","remaining","pauseTimer","timeUpdate","s","csrf_token","new_remaining","resetTimer","duration","markTaskComplete","completed","state"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useContext} from 'react'\nimport {fancyTimeFormat, getCookie, taskUpdate} from './utils'\nimport {ActiveTask} from './SortableList'\n\nconst Timer = ({ seconds, onTimeUpdate, markAsComplete }) => {\n    // initialize timeLeft with the seconds prop\n    const [timeLeft, setTimeLeft] = useState(seconds);\n  \n    useEffect(() => {\n      // exit early when we reach 0\n        if (!timeLeft) return;\n\n      // save intervalId to clear the interval when the\n      // component re-renders\n\n        const intervalId = setInterval(() => {\n        if (timeLeft > 0) {\n            setTimeLeft(timeLeft - 1);\n            onTimeUpdate(timeLeft)\n        }\n        }, 1000);\n        \n\n        if (timeLeft === 1) {\n            setTimeLeft(0);\n            onTimeUpdate(0);\n            markAsComplete();\n        }\n      // clear interval on re-render to avoid memory leaks\n        return () => clearInterval(intervalId);\n      // add timeLeft as a dependency to re-rerun the effect\n      // when we update it\n    }, [timeLeft]);\n\n    useEffect(() => {\n        setTimeLeft(seconds)\n    }, [seconds])\n\n    return (\n    <div>\n        <h1 className='has-text-success'>{fancyTimeFormat(timeLeft)}</h1>\n    </div>\n    );\n    };\n\nexport const StartTimer = ({ value, onTimerStart, onTimerPause, markAsComplete }) => {\n\n    const [timer, setTimer] = useState({'state': 'paused', 'seconds': '0'});\n    const {active, setActive} = useContext(ActiveTask);\n\n    function startTimer() {\n        setTimer({'state': 'running', 'seconds': value.remaining});\n        onTimerStart();\n        setActive(true);\n    }\n    \n    function pauseTimer() {\n        setTimer({'state': 'paused', 'seconds': '0'});\n        setActive(false);\n        onTimerPause();\n    }\n    \n    function timeUpdate(s) {\n        var csrf_token = getCookie('csrftoken');\n        \n        var new_remaining = value;\n        new_remaining.remaining = s;\n\n        taskUpdate(new_remaining, csrf_token)\n    }\n    \n    function resetTimer() {\n        setTimer({'state': 'running', 'seconds': value.duration});\n    }\n\n    function markTaskComplete() {\n        setActive(false);\n        markAsComplete();\n    }\n\n    return (\n        <div className={\"level-item \" + (value.completed ? 'is-hidden' : '')}>\n\n            {timer.state === 'paused' && active === false &&\n            <a href=\"/#\" onClick={startTimer}>\n                <span className=\"icon has-text-success\">\n                    <i className=\"fas fa-play\"></i>\n                </span>\n            </a>\n            }\n            \n            {timer.state === 'running' &&\n            <a href=\"/#\" onClick={pauseTimer}>\n                <span className=\"icon has-text-success\">\n                    <i className=\"fas fa-pause\"></i>\n                </span>\n            </a>\n            }\n\n            {timer.state === 'running' && \n            <Timer seconds={timer.seconds} onTimeUpdate={timeUpdate} markAsComplete={markTaskComplete}/>\n            }\n\n            {timer.state === 'running' &&\n                <a href=\"/#\">\n                    <span className=\"icon has-text-warning\" onClick={resetTimer}>\n                        &nbsp;&nbsp;\n                        <i className=\"fas fa-redo-alt\"></i>\n                    </span>\n                </a>\n            }\n\n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}