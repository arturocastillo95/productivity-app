{"ast":null,"code":"import _regeneratorRuntime from\"/Users/arturocastillo/developer/productivity-app/src/productivityreact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/Users/arturocastillo/developer/productivity-app/src/productivityreact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/Users/arturocastillo/developer/productivity-app/src/productivityreact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/arturocastillo/developer/productivity-app/src/productivityreact/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext,useRef}from'react';import{SortableContainer,SortableElement}from'react-sortable-hoc';import arrayMove from'array-move';function getCookie(name){var cookieValue=null;if(document.cookie&&document.cookie!==''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=cookies[i].trim();// Does this cookie string begin with the name we want?\nif(cookie.substring(0,name.length+1)===name+'='){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}return cookieValue;}function fancyTimeFormat(duration){// Hours, minutes and seconds\nvar hrs=~~(duration/3600);var mins=~~(duration%3600/60);var secs=~~duration%60;// Output like \"1:01\" or \"4:03:59\" or \"123:03:59\"\nvar ret=\"\";if(hrs>0){ret+=\"\"+hrs+\":\"+(mins<10?\"0\":\"\");}ret+=\"\"+mins+\":\"+(secs<10?\"0\":\"\");ret+=\"\"+secs;return ret;}var Timer=function Timer(_ref){var seconds=_ref.seconds,onTimeUpdate=_ref.onTimeUpdate;// initialize timeLeft with the seconds prop\nvar _useState=useState(seconds),_useState2=_slicedToArray(_useState,2),timeLeft=_useState2[0],setTimeLeft=_useState2[1];useEffect(function(){// exit early when we reach 0\nif(!timeLeft)return;// save intervalId to clear the interval when the\n// component re-renders\nvar intervalId=setInterval(function(){if(timeLeft>0){setTimeLeft(timeLeft-1);onTimeUpdate(timeLeft);}},1000);// clear interval on re-render to avoid memory leaks\nreturn function(){return clearInterval(intervalId);};// add timeLeft as a dependency to re-rerun the effect\n// when we update it\n},[timeLeft]);useEffect(function(){setTimeLeft(seconds);},[seconds]);return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",{className:\"has-text-success\"},fancyTimeFormat(timeLeft)));};var StartTimer=function StartTimer(_ref2){var value=_ref2.value,onTimerStart=_ref2.onTimerStart,onTimerPause=_ref2.onTimerPause;var _useState3=useState({'state':'paused','seconds':'0'}),_useState4=_slicedToArray(_useState3,2),timer=_useState4[0],setTimer=_useState4[1];var _useContext=useContext(ActiveTask),active=_useContext.active,setActive=_useContext.setActive;function startTimer(){setTimer({'state':'running','seconds':value.remaining});setActive(true);onTimerStart();}function pauseTimer(){setTimer({'state':'paused','seconds':'0'});setActive(false);onTimerPause();}function timeUpdate(s){var url='http://127.0.0.1:8000/api/task-update/'+value.id+'/';var csrf_token=getCookie('csrftoken');var new_remaining=value;new_remaining.remaining=s;fetch(url,{'method':'POST','headers':{'Content-Type':'application/json','X-CSRFToken':csrf_token},'body':JSON.stringify(value)});}return/*#__PURE__*/React.createElement(\"div\",{className:\"level-item \"+(value.completed?'is-hidden':'')},timer.state==='paused'&&active===false&&/*#__PURE__*/React.createElement(\"a\",{href:\"/#\",onClick:startTimer},/*#__PURE__*/React.createElement(\"span\",{className:\"icon has-text-success\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-play\"}))),timer.state==='running'&&/*#__PURE__*/React.createElement(\"a\",{href:\"/#\",onClick:pauseTimer},/*#__PURE__*/React.createElement(\"span\",{className:\"icon has-text-success\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-pause\"}))),timer.state==='running'&&/*#__PURE__*/React.createElement(Timer,{seconds:timer.seconds,onTimeUpdate:timeUpdate}));};var SortableItem=SortableElement(function(_ref3){var value=_ref3.value,onActivateTask=_ref3.onActivateTask,onDeleteTask=_ref3.onDeleteTask,onFinishedTask=_ref3.onFinishedTask;var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),active_style=_useState6[0],setActiveStyle=_useState6[1];function timerStarted(){onActivateTask(value.id);setActiveStyle(true);}return/*#__PURE__*/React.createElement(\"li\",{className:\"box \"+(active_style?'task-is-active':'')},/*#__PURE__*/React.createElement(\"div\",{className:\"level is-mobile\"},/*#__PURE__*/React.createElement(\"div\",{className:\"level-left\"},/*#__PURE__*/React.createElement(\"input\",{className:\" \"+(value.completed?'is-hidden':''),type:\"checkbox\",onChange:function onChange(){return onFinishedTask(value);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"level-item\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"title is-5 \"+(value.completed?'is-completed':'')},value.title)),/*#__PURE__*/React.createElement(\"div\",{className:\"level-right\"},/*#__PURE__*/React.createElement(StartTimer,{value:value,onTimerStart:timerStarted,onTimerPause:function onTimerPause(){return setActiveStyle(false);}}),/*#__PURE__*/React.createElement(\"div\",{className:\"level-item \"+(value.completed?'is-hidden':'')},/*#__PURE__*/React.createElement(\"a\",{href:\"#/\"},/*#__PURE__*/React.createElement(\"span\",{className:\"icon has-text-warning\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-edit\"})))),/*#__PURE__*/React.createElement(\"div\",{className:\"level-item\"},/*#__PURE__*/React.createElement(\"a\",{href:\"#/\",onClick:function onClick(e){return onDeleteTask(value);}},/*#__PURE__*/React.createElement(\"span\",{className:\"icon has-text-danger\"},/*#__PURE__*/React.createElement(\"i\",{className:\"fas fa-lg fa-times\"})))))));});var SortableComponent=SortableContainer(function(_ref4){var items=_ref4.items,onFocusTask=_ref4.onFocusTask,onDeleteTask=_ref4.onDeleteTask,onFinishedTask=_ref4.onFinishedTask;var _useState7=useState(items),_useState8=_slicedToArray(_useState7,2),tasks=_useState8[0],setTasks=_useState8[1];useEffect(function(){setTasks(items);},[items]);function setActiveTask(taskId){var index=items.findIndex(function(i){return i.id===taskId;});onFocusTask(index);}return/*#__PURE__*/React.createElement(\"ul\",null,items.map(function(value,index){return/*#__PURE__*/React.createElement(SortableItem,{key:value.id,index:index,value:value,onActivateTask:setActiveTask,onDeleteTask:onDeleteTask,onFinishedTask:onFinishedTask});}));});// Context\nexport var ActiveTask=React.createContext(false);export default function SortableList(_ref5){var newTaskCreated=_ref5.newTaskCreated;var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),tasks=_useState10[0],setTasks=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),active=_useState12[0],setActive=_useState12[1];var active_task={active:active,setActive:setActive};var isInitialMount=useRef(true);function fetchTasks(){return _fetchTasks.apply(this,arguments);}function _fetchTasks(){_fetchTasks=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch('http://127.0.0.1:8000/api/task-list/');case 2:response=_context.sent;return _context.abrupt(\"return\",response.json());case 4:case\"end\":return _context.stop();}}},_callee);}));return _fetchTasks.apply(this,arguments);};function updateIndex(data){data.forEach(function(task,index){var url='http://127.0.0.1:8000/api/task-update/'+task.id+'/';var csrf_token=getCookie('csrftoken');task.order=index;fetch(url,{'method':'POST','headers':{'Content-Type':'application/json','X-CSRFToken':csrf_token},'body':JSON.stringify(task)});});};function updateTask(t){var url='http://127.0.0.1:8000/api/task-update/'+t.id+'/';var csrf_token=getCookie('csrftoken');fetch(url,{'method':'POST','headers':{'Content-Type':'application/json','X-CSRFToken':csrf_token},'body':JSON.stringify(t)});};useEffect(function(){if(isInitialMount.current){isInitialMount.current=false;}else{fetchTasks().then(function(data){data.sort(function(a,b){return a.order>b.order?1:b.order>a.order?-1:0;});var index=data.findIndex(function(i){return i.title===newTaskCreated.title;});data=arrayMove(data,index,0);data.forEach(function(value,i){value.order=i;});setTasks(data);updateIndex(data);});}},[newTaskCreated]);useEffect(function(){fetch('http://127.0.0.1:8000/api/task-list/').then(function(response){return response.json();}).then(function(data){data.sort(function(a,b){return a.order>b.order?1:b.order>a.order?-1:0;});setTasks(data);});// return () => {\n//     cleanup\n// };\n},[]);var onSortEnd=function onSortEnd(_ref6){var oldIndex=_ref6.oldIndex,newIndex=_ref6.newIndex;var newOrder=_toConsumableArray(tasks);newOrder=arrayMove(newOrder,oldIndex,newIndex);updateIndex(newOrder);setTasks(newOrder);};function deleteTask(e){var newTasks=tasks.filter(function(i){return i.id!==e.id;});setTasks(newTasks);var csrf_token=getCookie('csrftoken');var url='http://127.0.0.1:8000/api/task-delete/'+e.id+'/';fetch(url,{method:'DELETE',headers:{'Content-Type':'application/json','X-CSRFToken':csrf_token}});}function getCurrentDate(){var date=new Date();var dd=String(date.getDate()).padStart(2,'0');var mm=String(date.getMonth()+1).padStart(2,'0');var year=date.getFullYear();var today=year+'-'+mm+'-'+dd;return today;}function markTaskAsComplete(e){var index=tasks.findIndex(function(i){return i.id===e.id;});var updates=_toConsumableArray(tasks);updates[index].completed=true;updates[index].finish_date=getCurrentDate();setTasks(updates);updateTask(updates[index]);}function focusTask(taskIndex){var focusTask=tasks[taskIndex];var newOrder=tasks;newOrder.splice(taskIndex,1);newOrder.unshift(focusTask);setTasks(newOrder);};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(ActiveTask.Provider,{value:active_task},/*#__PURE__*/React.createElement(SortableComponent,{items:tasks,onSortEnd:onSortEnd,onFocusTask:focusTask,onDeleteTask:deleteTask,onFinishedTask:markTaskAsComplete})));}","map":{"version":3,"sources":["/Users/arturocastillo/developer/productivity-app/src/productivityreact/src/components/SortableList.js"],"names":["React","useState","useEffect","useContext","useRef","SortableContainer","SortableElement","arrayMove","getCookie","name","cookieValue","document","cookie","cookies","split","i","length","trim","substring","decodeURIComponent","fancyTimeFormat","duration","hrs","mins","secs","ret","Timer","seconds","onTimeUpdate","timeLeft","setTimeLeft","intervalId","setInterval","clearInterval","StartTimer","value","onTimerStart","onTimerPause","timer","setTimer","ActiveTask","active","setActive","startTimer","remaining","pauseTimer","timeUpdate","s","url","id","csrf_token","new_remaining","fetch","JSON","stringify","completed","state","SortableItem","onActivateTask","onDeleteTask","onFinishedTask","active_style","setActiveStyle","timerStarted","title","e","SortableComponent","items","onFocusTask","tasks","setTasks","setActiveTask","taskId","index","findIndex","map","createContext","SortableList","newTaskCreated","active_task","isInitialMount","fetchTasks","response","json","updateIndex","data","forEach","task","order","updateTask","t","current","then","sort","a","b","onSortEnd","oldIndex","newIndex","newOrder","deleteTask","newTasks","filter","method","headers","getCurrentDate","date","Date","dd","String","getDate","padStart","mm","getMonth","year","getFullYear","today","markTaskAsComplete","updates","finish_date","focusTask","taskIndex","splice","unshift"],"mappings":"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","sourcesContent":["import React, {useState, useEffect, useContext, useRef} from 'react'\nimport {SortableContainer, SortableElement} from 'react-sortable-hoc';\nimport arrayMove from 'array-move';\n\nfunction getCookie(name) {\n    let cookieValue = null;\n    if (document.cookie && document.cookie !== '') {\n        const cookies = document.cookie.split(';');\n        for (let i = 0; i < cookies.length; i++) {\n            const cookie = cookies[i].trim();\n            // Does this cookie string begin with the name we want?\n            if (cookie.substring(0, name.length + 1) === (name + '=')) {\n                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));\n                break;\n            }\n        }\n    }\n    return cookieValue;\n}\n\n\nfunction fancyTimeFormat(duration)\n{   \n    // Hours, minutes and seconds\n    var hrs = ~~(duration / 3600);\n    var mins = ~~((duration % 3600) / 60);\n    var secs = ~~duration % 60;\n\n    // Output like \"1:01\" or \"4:03:59\" or \"123:03:59\"\n    var ret = \"\";\n\n    if (hrs > 0) {\n        ret += \"\" + hrs + \":\" + (mins < 10 ? \"0\" : \"\");\n    }\n\n    ret += \"\" + mins + \":\" + (secs < 10 ? \"0\" : \"\");\n    ret += \"\" + secs;\n    return ret;\n}\n\nconst Timer = ({ seconds, onTimeUpdate }) => {\n    // initialize timeLeft with the seconds prop\n    const [timeLeft, setTimeLeft] = useState(seconds);\n  \n    useEffect(() => {\n      // exit early when we reach 0\n        if (!timeLeft) return;\n\n      // save intervalId to clear the interval when the\n      // component re-renders\n        const intervalId = setInterval(() => {\n        if (timeLeft > 0) {\n            setTimeLeft(timeLeft - 1);\n            onTimeUpdate(timeLeft)\n        }\n        }, 1000);\n  \n      // clear interval on re-render to avoid memory leaks\n        return () => clearInterval(intervalId);\n      // add timeLeft as a dependency to re-rerun the effect\n      // when we update it\n    }, [timeLeft]);\n\n    useEffect(() => {\n        setTimeLeft(seconds)\n    }, [seconds])\n\n    return (\n    <div>\n        <h1 className='has-text-success'>{fancyTimeFormat(timeLeft)}</h1>\n    </div>\n    );\n    };\n\n\n\nconst StartTimer = ({ value, onTimerStart, onTimerPause }) => {\n\n    const [timer, setTimer] = useState({'state': 'paused', 'seconds': '0'});\n    const {active, setActive} = useContext(ActiveTask);\n\n    function startTimer() {\n        setTimer({'state': 'running', 'seconds': value.remaining});\n        setActive(true);\n        onTimerStart();\n    }\n\n    function pauseTimer() {\n        setTimer({'state': 'paused', 'seconds': '0'});\n        setActive(false);\n        onTimerPause();\n    }\n\n    function timeUpdate(s) {\n        var url = 'http://127.0.0.1:8000/api/task-update/' + value.id + '/';\n        var csrf_token = getCookie('csrftoken');\n\n        var new_remaining = value\n        new_remaining.remaining = s\n\n        fetch(url, {\n            'method': 'POST',\n            'headers': {\n                'Content-Type': 'application/json',\n                'X-CSRFToken': csrf_token,\n            },\n            'body': JSON.stringify(value)\n            });\n\n        }\n    \n    \n    return (\n        <div className={\"level-item \" + (value.completed ? 'is-hidden' : '')}>\n\n            {timer.state === 'paused' && active === false &&\n            <a href=\"/#\" onClick={startTimer}>\n                <span className=\"icon has-text-success\">\n                    <i className=\"fas fa-play\"></i>\n                </span>\n            </a>\n            }\n            \n            {timer.state === 'running' &&\n            <a href=\"/#\" onClick={pauseTimer}>\n                <span className=\"icon has-text-success\">\n                    <i className=\"fas fa-pause\"></i>\n                </span>\n            </a>\n            }\n\n            {timer.state === 'running' && \n            <Timer seconds={timer.seconds} onTimeUpdate={timeUpdate}/>\n            }\n\n        </div>\n    )\n}\n\n\n\nconst SortableItem = SortableElement(({value, onActivateTask, onDeleteTask, onFinishedTask}) => {\n    const [active_style, setActiveStyle] = useState(false)\n\n    function timerStarted() {\n        onActivateTask(value.id);\n        setActiveStyle(true);\n    }\n\n    return (\n        <li className={\"box \" + (active_style ? 'task-is-active': '')}>\n            <div className=\"level is-mobile\">\n                <div className=\"level-left\">\n                    <input className={\" \" + (value.completed ? 'is-hidden' : '')} type=\"checkbox\" onChange={() => onFinishedTask(value)}/>\n                </div>\n\n                <div className=\"level-item\">\n                    <h1 className={\"title is-5 \" + (value.completed ? 'is-completed': '')}>\n                        {value.title}\n                    </h1>\n                </div>\n\n                <div className=\"level-right\">\n\n                    <StartTimer value={value} onTimerStart={timerStarted} onTimerPause={() => setActiveStyle(false)}/>\n\n                    <div className={\"level-item \" + (value.completed ? 'is-hidden': '')}>\n                        <a href=\"#/\">\n                            <span className=\"icon has-text-warning\">\n                                <i className=\"fas fa-edit\"></i>\n                            </span>\n                        </a>\n                    </div>\n\n                    <div className=\"level-item\">\n                        <a href=\"#/\" onClick={e => onDeleteTask(value)}>\n                            <span className=\"icon has-text-danger\">\n                                <i className=\"fas fa-lg fa-times\"></i>\n                            </span>\n                        </a>\n                    </div>\n\n                </div>\n\n            </div>\n        </li>\n    )\n});\n\nconst SortableComponent = SortableContainer(({items, onFocusTask, onDeleteTask, onFinishedTask}) => {\n    const [tasks, setTasks] = useState(items);\n\n    useEffect(() => {\n        setTasks(items)\n    }, [items])\n\n    function setActiveTask(taskId) {\n        var index = items.findIndex(i => i.id === taskId);\n        onFocusTask(index);\n    }\n\n    return (\n    <ul>\n        {items.map((value, index) => (\n            <SortableItem key={value.id} index={index} value={value} onActivateTask={setActiveTask} onDeleteTask={onDeleteTask} onFinishedTask={onFinishedTask}/>\n        ))}\n    </ul>\n    )\n})\n\n\n// Context\nexport const ActiveTask = React.createContext(false)\n\nexport default function SortableList({ newTaskCreated }) {\n    const [tasks, setTasks] = useState([]);\n    const [active, setActive] = useState(false);\n    const active_task = {active, setActive};\n    const isInitialMount = useRef(true);\n\n    async function fetchTasks() {\n        var response = await fetch('http://127.0.0.1:8000/api/task-list/');\n        return response.json()\n    };\n\n    function updateIndex(data) {\n        data.forEach((task, index) => {\n            var url = 'http://127.0.0.1:8000/api/task-update/' + task.id + '/'\n            var csrf_token = getCookie('csrftoken');\n            task.order = index;\n            fetch(url, {\n                'method': 'POST',\n                'headers': {\n                    'Content-Type': 'application/json',\n                    'X-CSRFToken': csrf_token,\n                },\n                'body': JSON.stringify(task)\n            });\n        });\n    };\n\n    function updateTask(t) {\n        var url = 'http://127.0.0.1:8000/api/task-update/' + t.id + '/'\n        var csrf_token = getCookie('csrftoken');\n\n        fetch(url, {\n            'method': 'POST',\n            'headers': {\n                'Content-Type': 'application/json',\n                'X-CSRFToken': csrf_token,\n            },\n            'body': JSON.stringify(t)\n        });\n\n    };\n\n    useEffect(() => {\n        if (isInitialMount.current) {\n            isInitialMount.current = false;\n        } else {\n            fetchTasks().then(data => {\n                data.sort((a, b) => (a.order > b.order) ? 1 : ((b.order > a.order) ? -1 : 0));\n                var index = data.findIndex(i => i.title === newTaskCreated.title);\n                data = arrayMove(data, index, 0);\n                data.forEach((value, i) => {\n                    value.order = i;\n                })\n                setTasks(data);\n                updateIndex(data);\n            })\n        }\n\n    }, [newTaskCreated])\n\n    useEffect(() => {\n        fetch('http://127.0.0.1:8000/api/task-list/')\n        .then(response => response.json())\n        .then(data => {\n            data.sort((a, b) => (a.order > b.order) ? 1 : ((b.order > a.order) ? -1 : 0));\n            setTasks(data);\n            }\n        )\n        // return () => {\n        //     cleanup\n        // };\n    }, []);\n\n    const onSortEnd =  ({oldIndex, newIndex}) => {\n        var newOrder = [...tasks];\n        newOrder = arrayMove(newOrder, oldIndex, newIndex);\n                        \n        updateIndex(newOrder);\n        setTasks(newOrder);\n\n    };\n\n    function deleteTask(e) {\n        var newTasks = tasks.filter(i => i.id !== e.id);\n        setTasks(newTasks);\n\n        var csrf_token = getCookie('csrftoken');\n        var url = 'http://127.0.0.1:8000/api/task-delete/' + e.id + '/';\n\n        fetch(url, {\n            method: 'DELETE',\n            headers: {\n                'Content-Type': 'application/json',\n                'X-CSRFToken': csrf_token,\n            }\n        })\n    }\n\n    function getCurrentDate() {\n        var date = new Date();\n        var dd = String(date.getDate()).padStart(2,'0');\n        var mm = String(date.getMonth() + 1).padStart(2,'0');\n        var year = date.getFullYear();\n\n        var today = year + '-' + mm + '-' + dd;\n        return today;\n    }\n\n    function markTaskAsComplete(e) {\n        var index = tasks.findIndex(i => i.id === e.id)\n        var updates = [...tasks];\n        updates[index].completed = true;\n        updates[index].finish_date = getCurrentDate();\n\n        setTasks(updates);\n        updateTask(updates[index]);\n    }\n\n\n    function focusTask(taskIndex) {\n        var focusTask = tasks[taskIndex];\n        var newOrder = tasks;\n        newOrder.splice(taskIndex, 1);\n        newOrder.unshift(focusTask);\n\n        setTasks(newOrder);\n\n    };\n\n    return (\n        <>\n        <ActiveTask.Provider value={active_task}>\n            <SortableComponent items={tasks} onSortEnd={onSortEnd} onFocusTask={focusTask} onDeleteTask={deleteTask} onFinishedTask={markTaskAsComplete}/>\n        </ActiveTask.Provider>\n        </>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}